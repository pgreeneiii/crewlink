<% if @friends.present? %>
<% page_header "Search Results:" %>
   <div class="row">
     <div class="col-md-12">
       <table class="table table-striped table-hover">
         <tr>
           <th>Username</th>
           <th>First Name</th>
           <th>Last Name</th>
           <th>Actions</th>
         </tr>

         <% @friends.each do |friend| %>
         <tr>
           <td><%= friend.username %></td>
           <td><%= friend.first_name %></td>
           <td><%= friend.last_name %></td>
           <td>
              <% if current_user.friends_with?(friend) %>
                  <form action="/remove_friend/<%= friend.id %>" method="post">
                     <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">
                     <button class="btn btn-danger">
                       Remove Friend
                     </button>
                  </form>
                <% else %>
                  <% check = false %>
                  <% current_user.pending_friends.each do |request| %>
                     <% if friend.id == request.id %>
                        <% check = true %>
                     <% end %>
                  <% end %>
                  <% friend.pending_friends.each do |request| %>
                     <% if current_user.id == request.id %>
                        <% check = true %>
                     <% end %>
                  <% end %>

                  <% if check == true %>
                     <button class="btn btn-success" disabled="disabled">
                        Request Pending
                     </button>
                  <% else %>
                   <form action="/send_request" method="post">
                     <input name="authenticity_token" type="hidden" value="<%= form_authenticity_token %>">

                     <input type="hidden" name="id" value="<%= friend.id %>">

                     <button class="btn btn-success">
                       Add Friend
                     </button>
                  </form>
                  <% end %>
                <% end %>
           </td>
         </tr>
         <% end %>
       </table>
     </div>
   </div>
<% else %>
<% page_header "No Matching Results." %>
<% end %>
